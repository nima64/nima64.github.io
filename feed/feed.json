{
	"version": "https://jsonfeed.org/version/1.1",
	"title": "nyima tamang blog",
	"language": "en",
	"home_page_url": "https://example.com/",
	"feed_url": "https://example.com/feed/feed.json",
	"description": "blog about math and computer science",
	"author": {
		"name": "nyima tamang",
		"url": "https://nima64.github.io/"
	},
	"items": [
		{
			"id": "https://example.com/blog/gsoc/gosc-6-24/",
			"url": "https://example.com/blog/gsoc/gosc-6-24/",
			"title": "Summer of code with Video Lan",
			"content_html": "<h2 id=\"overview-of-the-code\" tabindex=\"-1\">Overview of the Code <a class=\"header-anchor\" href=\"https://example.com/blog/gsoc/gosc-6-24/\">#</a></h2>\n<p><a href=\"https://github.com/thebamby/vlc-SmartLoad/pull/1\">Updated SmartLoad extension to support VLC 4.0</a><br>\n<a href=\"https://code.videolan.org/nima64/vlc/-/tree/autorun-module?ref_type=heads\">Auto-run branch</a><br>\n<a href=\"https://code.videolan.org/nima64/vlc/-/tree/tests-improvements?ref_type=heads\">Test improvements branch</a><br>\n<a href=\"https://code.videolan.org/nima64/vlc/-/tree/CMD_SET_INPUT-removal?ref_type=heads\">Remove traces of CMD_SET_INPUT branch</a><br>\n<a href=\"https://code.videolan.org/nima64/vlc/-/commit/cb2244b6f81d5c38e9aaddaf83aee09cd0905693\">Fixed Meta_Changed function from segfaulting branch</a></p>\n<h2 id=\"background\" tabindex=\"-1\">Background <a class=\"header-anchor\" href=\"https://example.com/blog/gsoc/gosc-6-24/\">#</a></h2>\n<h3 id=\"building-vlc\" tabindex=\"-1\">Building VLC <a class=\"header-anchor\" href=\"https://example.com/blog/gsoc/gosc-6-24/\">#</a></h3>\n<p>The latest repo is on <a href=\"https://code.videolan.org/videolan/vlc/\">gitlab</a> they have two build systems <strong>meson</strong> and <strong>gnu autotools</strong>.</p>\n<p>I ended up choosing meson because it generates a ninja builds which is significantly faster on my system than auto tools. Ninja also produces a compile_commands.json which is need for clangd setup.</p>\n<p>A blocking point in building vlc was finding the right the packages. Specifically qt packages which sometimes couldn't be recognized by pkg-conf. Eventually I found the packages from Ubuntu 21.10 worked, alternatively I could have built QT from source. I wasn't comfortable building QT, so I stuck with the latter.</p>\n<p>I found the correct packages to install from the looking at the QT build decencies in <em>vlc/modules/gui/qt/meson.build</em>. I would also look in vlc's docker images for finding linux dependencies.</p>\n<blockquote>\n<p>Note: to generate a compile_commands.json on autoools use bear.<br>\nAnd run <code>bear -- make</code></p>\n</blockquote>\n<pre class=\"language-js\" tabindex=\"0\"><code class=\"language-js\"><span class=\"token literal-property property\">modules</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token string\">'Core'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Gui'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Widgets'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Svg'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Qml'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'QmlModels'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'QuickLayouts'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'QuickTemplates2'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'QmlWorkerScript'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'Quick'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'QuickControls2'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'ShaderTools'</span>\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></code></pre>\n<h3 id=\"comprehending-the-code-base\" tabindex=\"-1\">Comprehending the code base <a class=\"header-anchor\" href=\"https://example.com/blog/gsoc/gosc-6-24/\">#</a></h3>\n<p>Some useful resources<br>\n<a href=\"https://example.com/blog/gsoc/gosc-6-24/\">https://wiki.videolan.org/Hacker_Guide/</a><br>\n<a href=\"https://example.com/blog/gsoc/gosc-6-24/\">https://mfkl.gumroad.com/l/libvlc-good-parts</a><br>\n<a href=\"https://example.com/blog/gsoc/gosc-6-24/\">https://www.doxygen.nl/manual/</a></p>\n<p>I would recommend compiling your own documentation for source graphs. There are libvlc and libvlccore doxygen documentation online, but that didn't include any of the extensions system.</p>\n<h3 id=\"vlc-extension-system\" tabindex=\"-1\">VLC Extension System <a class=\"header-anchor\" href=\"https://example.com/blog/gsoc/gosc-6-24/\">#</a></h3>\n<p>Since my project is based around the lua extension system I will attempt to explain and show how it works in a brief paragraph.</p>\n<p>The key part in the extension system that controls the communication between vlc and extension code is the <em>extension manager</em>.\nThe extension manager holds all the extension data and contains a function, called control, which is the api that will handle commands. The function gets passed different command enums such as activate, deactivate, is_active... etc. And how the commands get handled is dependant your implementation.</p>\n<p>The implementation from the lua module says that commands will get pushed onto queue. And on separate thread &quot;extension thread&quot; will execute commands and trigger a function in the lua code.\n<picture><source type=\"image/avif\" srcset=\"https://example.com/img/QdVW8DtiSD-2752.avif 2752w\"><source type=\"image/webp\" srcset=\"https://example.com/img/QdVW8DtiSD-2752.webp 2752w\"><img alt=\"test\" loading=\"lazy\" decoding=\"async\" src=\"https://example.com/img/QdVW8DtiSD-2752.jpeg\" width=\"2752\" height=\"1040\"></picture></p>\n<h2 id=\"what-i-did\" tabindex=\"-1\">What I did <a class=\"header-anchor\" href=\"https://example.com/blog/gsoc/gosc-6-24/\">#</a></h2>\n<h3 id=\"removing-cmd-set-input\" tabindex=\"-1\">Removing CMD_SET_INPUT <a class=\"header-anchor\" href=\"https://example.com/blog/gsoc/gosc-6-24/\">#</a></h3>\n<p><a href=\"https://code.videolan.org/videolan/vlc/-/merge_requests/3240\">my mentors work</a></p>\n<p><a href=\"https://code.videolan.org/nima64/vlc/-/tree/CMD_SET_INPUT-removal?ref_type=heads\">Remove traces of CMD_SET_INPUT branch</a></p>\n<p>This was a continuation of my mentors work deprecating CMD_SET_INPUT through ui commands, since it now gets binded to player's input changed event.</p>\n<h3 id=\"adding-missing-testing\" tabindex=\"-1\">Adding missing Testing <a class=\"header-anchor\" href=\"https://example.com/blog/gsoc/gosc-6-24/\">#</a></h3>\n<p><a href=\"https://code.videolan.org/nima64/vlc/-/compare/master...tests-improvements?from_project_id=435\">Test improvements branch</a></p>\n<p>One of the goals for my project is to create tests for the extension commands. Only playing_changed had been done the rest needed to be implemented. Testing each command is just checking if the callback in the lua code got executed. The is achieved through blocking our main thread with a semaphore until the lua callback is triggered, from extension thread, signals to unblock the code.</p>\n<pre class=\"language-c\" tabindex=\"0\"><code class=\"language-c\"><span class=\"token keyword\">typedef</span> <span class=\"token keyword\">enum</span>\n<span class=\"token punctuation\">{</span>\n    CMD_ACTIVATE <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n    CMD_DEACTIVATE<span class=\"token punctuation\">,</span>\n    CMD_TRIGGERMENU<span class=\"token punctuation\">,</span>    <span class=\"token comment\">/* Arg1 = int*, pointing to id to trigger. free */</span>\n    CMD_CLICK<span class=\"token punctuation\">,</span>          <span class=\"token comment\">/* Arg1 = extension_widget_t* */</span>\n    CMD_CLOSE<span class=\"token punctuation\">,</span>\n    CMD_SET_INPUT<span class=\"token punctuation\">,</span>      <span class=\"token comment\">/* No arg. Just signal current input changed */</span>\n    CMD_UPDATE_META<span class=\"token punctuation\">,</span>    <span class=\"token comment\">/* No arg. Just signal current input item meta changed */</span>\n    CMD_PLAYING_CHANGED <span class=\"token comment\">/* Arg1 = int*, New playing status  */</span>\n<span class=\"token punctuation\">}</span> command_type_e<span class=\"token punctuation\">;</span>\n</code></pre>\n<h3 id=\"auto-run-feature\" tabindex=\"-1\">Auto-run feature <a class=\"header-anchor\" href=\"https://example.com/blog/gsoc/gosc-6-24/\">#</a></h3>\n<p><a href=\"https://code.videolan.org/videolan/vlc/-/merge_requests/5795/commits#note_448656\">Auto-run Merge Request</a></p>\n<p>Ideally extensions should be isolated in their own process and have a proper permission system which prompts the user when it uses features that are possible security risks like accessing the filesystem.\nCurrently the new Autorun Start function is not 100% done, it loads the data and the starting of the new extension threads and enabling marked extensions is naively done through the extension manager.</p>\n<p><picture><source type=\"image/avif\" srcset=\"https://example.com/img/lWwuuRp4Up-2918.avif 2918w\"><source type=\"image/webp\" srcset=\"https://example.com/img/lWwuuRp4Up-2918.webp 2918w\"><img alt=\"test\" loading=\"lazy\" decoding=\"async\" src=\"https://example.com/img/lWwuuRp4Up-2918.jpeg\" width=\"2918\" height=\"2207\"></picture></p>\n<h2 id=\"future-work\" tabindex=\"-1\">Future Work <a class=\"header-anchor\" href=\"https://example.com/blog/gsoc/gosc-6-24/\">#</a></h2>\n<ul>\n<li>\n<p>AutorunStart should create marked extension threads and enabled them.</p>\n</li>\n<li>\n<p>Extension thread should also be stopped by the last module using the state shared_ptr.</p>\n</li>\n</ul>\n<h2 id=\"hurdles-and-what-i-learned-from-them\" tabindex=\"-1\">Hurdles and What I learned From them <a class=\"header-anchor\" href=\"https://example.com/blog/gsoc/gosc-6-24/\">#</a></h2>\n<p>For large code bases make sure you understand the common code and libraries. For example in vlc how is oop implement, what are interfaces and modules.\nDon't focus on understanding what every line of code is doing, instead try to look at the big picture, what is this chunk of code doing?</p>\n<p>Ask questions, so you don't waste your time getting stuck on a problem for too long.</p>\n<p>Effective communication is incredibly important this is something I struggled with, learning how to communicate your ideas effectively and clearly is very difficult the idea in your head might be different than what someone else's. Being able to show what you mean so both parties can come to consensus is very important to a successful collaboration. For a complex module I found sharing diagrams to express the general idea first before proceeding to code was a huge time saver, so my mentor could check the validity of the idea before I started coding.</p>\n<h2 id=\"conclusion\" tabindex=\"-1\">Conclusion <a class=\"header-anchor\" href=\"https://example.com/blog/gsoc/gosc-6-24/\">#</a></h2>\n<p>I'm grateful to be able to partake in g'soc 24 with VLC. I was in awe of the inner workings of VLC. For the future I want to contribute more performance optimizations and low level related code like a video filter or adding the caching playlist probing.</p>\n<p>Thank you Alexandre Janniaux for your patience with me, teaching me to be better communicator, for always being there to support me and answer my questions and overall being an amazing mentor. And thank you Jean-Baptiste Kempf for making this possible.</p>\n",
			"date_published": "2024-06-01T00:00:00Z"
		}
		,
		{
			"id": "https://example.com/blog/svd-image-compression/",
			"url": "https://example.com/blog/svd-image-compression/",
			"title": "Singular Value Decomposition and it&#39;s use in Image compression.",
			"content_html": "<p>While reading through Strang's <em>Linear Algebra and It's Applications</em> I came upon this passage about SVD and one of it's many applications image compression.</p>\n<p><picture><source type=\"image/avif\" srcset=\"https://example.com/img/_Z8w6LZVpo-1584.avif 1584w\"><source type=\"image/webp\" srcset=\"https://example.com/img/_Z8w6LZVpo-1584.webp 1584w\"><img alt=\"test\" loading=\"lazy\" decoding=\"async\" src=\"https://example.com/img/_Z8w6LZVpo-1584.png\" width=\"1584\" height=\"926\"></picture></p>\n<p>SVD can be rewritten in a more compact form with the outer product being explicit.</p>\n<p>$$\\sum_{k=1}^{r}\\sigma_{k}u_{k} \\otimes v_{k}$$</p>\n<h2 id=\"how-svd-compression-works\" tabindex=\"-1\">How SVD Compression Works <a class=\"header-anchor\" href=\"https://example.com/blog/svd-image-compression/\">#</a></h2>\n<p>SVD compression lies on the fact most of the information is contained in very few singular values $$\\sigma$$ being very large while the rest are close to 0.</p>\n<p>The example by Strang: given a 1000x1000 matrix and say 98% of singular values are close to zero then we can get rid of them. So that only leaves us with 20 singular values, r=20, from the summation we only need 20 columns of U and V^T to reproduce the image.</p>\n<h2 id=\"testing-it-in-code-with-stbi-and-eigen\" tabindex=\"-1\">Testing it in code with stbi and Eigen <a class=\"header-anchor\" href=\"https://example.com/blog/svd-image-compression/\">#</a></h2>\n<pre class=\"language-cpp\" tabindex=\"0\"><code class=\"language-cpp\"><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;Eigen/Dense></span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;cstdio></span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;cstdlib></span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;fstream></span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;iostream></span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;malloc/_malloc.h></span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;vector></span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">STB_IMAGE_IMPLEMENTATION</span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">\"stb_image.h\"</span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">STB_IMAGE_WRITE_IMPLEMENTATION</span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">\"stb_image_write.h\"</span></span>\n\n<span class=\"token keyword\">using</span> <span class=\"token keyword\">namespace</span> Eigen<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">void</span> <span class=\"token function\">compressImage</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>path<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">int</span> x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> n<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>data <span class=\"token operator\">=</span> <span class=\"token function\">stbi_load</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>x<span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>y<span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>n<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">int</span> dataSize <span class=\"token operator\">=</span> x <span class=\"token operator\">*</span> y<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>data <span class=\"token operator\">==</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    std<span class=\"token double-colon punctuation\">::</span><span class=\"token function\">perror</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Failed to Open File!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"x:%d y:%d n:%d\\n\"</span><span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  Eigen<span class=\"token double-colon punctuation\">::</span>MatrixXd <span class=\"token function\">imgXY</span><span class=\"token punctuation\">(</span>y<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// Correct the order of y and x</span>\n\n  Eigen<span class=\"token double-colon punctuation\">::</span>Vector3f <span class=\"token function\">greyConversion</span><span class=\"token punctuation\">(</span><span class=\"token number\">0.299</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.587</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.114</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> dataSize<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">auto</span> dataRGB <span class=\"token operator\">=</span>\n        <span class=\"token class-name\">Eigen</span><span class=\"token double-colon punctuation\">::</span><span class=\"token function\">Vector3f</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">[</span>i <span class=\"token operator\">*</span> n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">[</span>i <span class=\"token operator\">*</span> n <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">[</span>i <span class=\"token operator\">*</span> n <span class=\"token operator\">+</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">int</span> greyCode <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span>dataRGB<span class=\"token punctuation\">.</span><span class=\"token function\">dot</span><span class=\"token punctuation\">(</span>greyConversion<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">int</span> row <span class=\"token operator\">=</span> i <span class=\"token operator\">/</span> x<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">int</span> col <span class=\"token operator\">=</span> i <span class=\"token operator\">%</span> x<span class=\"token punctuation\">;</span>\n    <span class=\"token function\">imgXY</span><span class=\"token punctuation\">(</span>row<span class=\"token punctuation\">,</span> col<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> greyCode<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  BDCSVD<span class=\"token operator\">&lt;</span>MatrixXd<span class=\"token operator\">></span> <span class=\"token function\">svd</span><span class=\"token punctuation\">(</span>imgXY<span class=\"token punctuation\">,</span> ComputeFullU <span class=\"token operator\">|</span> Eigen<span class=\"token double-colon punctuation\">::</span>ComputeFullV<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  Eigen<span class=\"token double-colon punctuation\">::</span>VectorXd singularValues <span class=\"token operator\">=</span> svd<span class=\"token punctuation\">.</span><span class=\"token function\">singularValues</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">auto</span> i <span class=\"token operator\">=</span> singularValues<span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token number\">350</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">!=</span> singularValues<span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    singularValues<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">auto</span> U <span class=\"token operator\">=</span> svd<span class=\"token punctuation\">.</span><span class=\"token function\">matrixU</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">auto</span> V <span class=\"token operator\">=</span> svd<span class=\"token punctuation\">.</span><span class=\"token function\">matrixV</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  Eigen<span class=\"token double-colon punctuation\">::</span>MatrixXd mSV <span class=\"token operator\">=</span> singularValues<span class=\"token punctuation\">.</span><span class=\"token function\">asDiagonal</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toDenseMatrix</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  mSV<span class=\"token punctuation\">.</span><span class=\"token function\">conservativeResize</span><span class=\"token punctuation\">(</span>U<span class=\"token punctuation\">.</span><span class=\"token function\">cols</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> V<span class=\"token punctuation\">.</span><span class=\"token function\">cols</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"U cols: %lu rows: %lu\\n\"</span><span class=\"token punctuation\">,</span> U<span class=\"token punctuation\">.</span><span class=\"token function\">cols</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> U<span class=\"token punctuation\">.</span><span class=\"token function\">rows</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"msv cols: %lu rows: %lu\\n\"</span><span class=\"token punctuation\">,</span> mSV<span class=\"token punctuation\">.</span><span class=\"token function\">cols</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> mSV<span class=\"token punctuation\">.</span><span class=\"token function\">rows</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"V cols: %lu rows: %lu\\n\"</span><span class=\"token punctuation\">,</span> V<span class=\"token punctuation\">.</span><span class=\"token function\">cols</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> V<span class=\"token punctuation\">.</span><span class=\"token function\">rows</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Reconstruct the image matrix</span>\n  MatrixXd cImgMat <span class=\"token operator\">=</span> U <span class=\"token operator\">*</span> mSV <span class=\"token operator\">*</span> V<span class=\"token punctuation\">.</span><span class=\"token function\">transpose</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// convert to char for stbi</span>\n  std<span class=\"token double-colon punctuation\">::</span>vector<span class=\"token operator\">&lt;</span><span class=\"token keyword\">char</span><span class=\"token operator\">></span> charVec<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> row <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> row <span class=\"token operator\">&lt;</span> cImgMat<span class=\"token punctuation\">.</span><span class=\"token function\">rows</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> row<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> col <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> col <span class=\"token operator\">&lt;</span> cImgMat<span class=\"token punctuation\">.</span><span class=\"token function\">cols</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> col<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      charVec<span class=\"token punctuation\">.</span><span class=\"token function\">push_back</span><span class=\"token punctuation\">(</span><span class=\"token function\">cImgMat</span><span class=\"token punctuation\">(</span>row<span class=\"token punctuation\">,</span> col<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// stride is size of each row</span>\n  <span class=\"token function\">stbi_write_png</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"lennaBW.png\"</span><span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> charVec<span class=\"token punctuation\">.</span><span class=\"token function\">data</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                 <span class=\"token keyword\">sizeof</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">char</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">stbi_image_free</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">compressImage</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"lenna.png\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre>\n<h2 id=\"the-result\" tabindex=\"-1\">The result <a class=\"header-anchor\" href=\"https://example.com/blog/svd-image-compression/\">#</a></h2>\n<p>The image was converted gray scale for the sake of simplicity, for color you need to run SVD on all the channels.</p>\n<p><picture><source type=\"image/avif\" srcset=\"https://example.com/img/mHUjXZAPLB-512.avif 512w\"><source type=\"image/webp\" srcset=\"https://example.com/img/mHUjXZAPLB-512.webp 512w\"><img alt=\"test\" loading=\"lazy\" decoding=\"async\" src=\"https://example.com/img/mHUjXZAPLB-512.png\" width=\"512\" height=\"512\"></picture>\n<picture><source type=\"image/avif\" srcset=\"https://example.com/img/nQqlggC60c-512.avif 512w\"><source type=\"image/webp\" srcset=\"https://example.com/img/nQqlggC60c-512.webp 512w\"><img alt=\"test\" loading=\"lazy\" decoding=\"async\" src=\"https://example.com/img/nQqlggC60c-512.png\" width=\"512\" height=\"512\"></picture></p>\n",
			"date_published": "2023-12-01T00:00:00Z"
		}
		
	]
}
